[pytest]
# ------------------------------------------------------------
# Annolid pytest configuration (repo-root pytest.ini)
# ------------------------------------------------------------

# Only collect tests from the dedicated tests folder.
# This avoids importing GUI-heavy modules during test discovery.
testpaths =
    tests

# Test discovery rules
python_files = test_*.py
python_functions = test_*
python_classes = Test*

# If pytest-asyncio is installed, this enables async tests smoothly.
asyncio_mode = auto

# Common markers used in Annolid-style projects (ML + GUI + video IO)
markers =
    unit: fast, isolated unit tests
    integration: integration tests (deselect with '-m "not integration"')
    slow: long-running tests (model inference, large video IO)
    gpu: requires CUDA / GPU
    network: requires network access (downloads, APIs)
    data: requires external datasets present on disk
    gui: requires a GUI/display (Qt)
    video: video IO / ffmpeg / codec-dependent tests

# Default options (clean output + consistent imports + marker hygiene)
addopts =
    -v
    -ra
    --tb=short
    --strict-markers
    --import-mode=prepend

# Avoid recursing into large/non-test trees during collection
norecursedirs =
    .git
    .venv
    build
    dist
    docs
    book
    docker
    assets
    notebooks
    __pycache__

# Keep output readable (ML stacks are noisy)
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::UserWarning

# Live logging during tests
log_cli = true
log_cli_level = INFO

# Optional: enable per-test timeouts if you use pytest-timeout
# addopts =
#     --timeout=120
